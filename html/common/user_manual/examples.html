

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>4. Examples &mdash; BRAILS 3.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
        <script src="../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5. Bugs &amp; Feature Requests" href="bugs.html" />
    <link rel="prev" title="3. Troubleshooting" href="troubleshooting.html" />
<script src="https://cdn.jsdelivr.net/npm/vega@5.12.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.13.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.8.0"></script>
<style media="screen">.vega-actions a {margin-right: 5px;}</style>
<link href="../../_static/css/bootstrap.css" rel="stylesheet">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F2F2F2" >
          
<a href="https://simcenter.designsafe-ci.org/" style="margin-bottom: 0px;">
  <img src="../../_static/SimCenter_logo.png" class="logo" alt="Org-Logo" />
</a>
<hr style="margin: 0px;">

  <a href="../../index.html">


  <img src="../../_static/SimCenter_BRAILS_logo_solo.png" class="logo" alt="Logo"/>
</a>


  
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/about.html">1. About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/acknowledgements.html">2. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/license.html">3. Copyright and License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/cite.html">4. How to Cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/glossary.html">5. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/abbreviations.html">6. Abbreviations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/releasenotes.html">7. Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="userGuide.html">2. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">3. Troubleshooting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-1-inventory-generation-using-brails">4.1. Example 1: Inventory Generation Using BRAILS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-2-calling-individual-modules-of-brails">4.2. Example 2: Calling Individual Modules of BRAILS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-3-retraining-existing-modules-of-brails">4.3. Example 3: Retraining Existing Modules of BRAILS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bugs.html">5. Bugs &amp; Feature Requests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../technical_manual/theory.html">1. Theory and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technical_manual/vnv.html">2. Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technical_manual/understand.html">3. Generalization</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BRAILS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">4. </span>Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/common/user_manual/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<span id="lbl-examples"></span><h1><span class="section-number">4. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h1>
<div class="section" id="example-1-inventory-generation-using-brails">
<h2><span class="section-number">4.1. </span>Example 1: Inventory Generation Using BRAILS<a class="headerlink" href="#example-1-inventory-generation-using-brails" title="Permalink to this heading">¶</a></h2>
<p>This example shows you how to use the BRAILS InventoryGenerator workflow to obtain the building inventory for an area. At the minimum, <code class="code highlight python docutils literal highlight-python"><span class="n">InventoryGenerator</span></code> requires the user to provide location information and a Google API key using <code class="code highlight python docutils literal highlight-python"><span class="n">location</span></code> and <code class="code highlight python docutils literal highlight-python"><span class="n">GoogleAPIKey</span></code> input parameters. Each time <code class="code highlight python docutils literal highlight-python"><span class="n">InventoryGenerator</span></code> is executed, it will use Google APIs to access satellite and street-level imagery of the buildings in the defined area. Given that accessing these images requires using Google credits, it is advised to experiment with <code class="code highlight python docutils literal highlight-python"><span class="n">InventoryGenerator</span></code> for a few buildings using the <code class="code highlight python docutils literal highlight-python"><span class="n">nbldgs</span></code> input parameter.</p>
<p>The code snippet below runs <code class="code highlight python docutils literal highlight-python"><span class="n">InventoryGenerator</span></code> for San Rafael, CA, and obtains the number of floors, roof shape, and building height information for a randomly selected 20 buildings from this area. Once the code is executed, it prints the obtained inventory and saves it in an inventory file titled inventory.csv in the directory the code is executed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">brails.InventoryGenerator</span> <span class="kn">import</span> <span class="n">InventoryGenerator</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># Initialize InventoryGenerator:</span>
<span class="linenos"> 4</span><span class="n">invGenerator</span> <span class="o">=</span> <span class="n">InventoryGenerator</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;San Rafael, CA&#39;</span><span class="p">,</span>
<span class="linenos"> 5</span>                                  <span class="n">nbldgs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">randomSelection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 6</span>                                  <span class="n">GoogleAPIKey</span><span class="o">=</span><span class="s2">&quot;PROVIDE_YOUR_KEY&quot;</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1"># Run InventoryGenerator to obtain a 10-building inventory from the entered location:</span>
<span class="linenos"> 9</span><span class="c1"># To run InventoryGenerator for all enabled attributes set attributes=&#39;all&#39;:</span>
<span class="linenos">10</span><span class="n">invGenerator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numstories&#39;</span><span class="p">,</span><span class="s1">&#39;roofshape&#39;</span><span class="p">,</span><span class="s1">&#39;buildingheight&#39;</span><span class="p">])</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># View generated inventory:</span>
<span class="linenos">13</span><span class="n">invGenerator</span><span class="o">.</span><span class="n">inventory</span>
</pre></div>
</div>
<p>The contents of inventory.csv file will appear as follows. Given <code class="code highlight python docutils literal highlight-python"><span class="n">randomSelection</span></code> was set to <code class="code highlight python docutils literal highlight-python"><span class="kc">True</span></code>, it is expected that the information stored in inventory.csv will be different each time this code is executed.</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>footprint,nstories,buildingheight,roofshape
<span class="linenos"> 2</span>&quot;POLYGON ((-122.5259147 37.9248895, -122.5258144 37.9248847, -122.5258197 37.9248163, -122.5258415 37.9248174, -122.5258465 37.9247523, -122.5259084 37.9247553, -122.5259072 37.9247703, -122.5259239 37.9247711, -122.5259147 37.9248895))&quot;,2,53.1,Flat
<span class="linenos"> 3</span>&quot;POLYGON ((-122.5307269 37.9267442, -122.5306426 37.9266658, -122.5305552 37.9267052, -122.5305798 37.9267415, -122.5304688 37.926789, -122.5305144 37.9268474, -122.5307269 37.9267442))&quot;,2,52.8,Hip
<span class="linenos"> 4</span>&quot;POLYGON ((-122.5283394 37.927182, -122.5283711 37.9273104, -122.5282511 37.9273288, -122.5282194 37.9272004, -122.5283394 37.927182))&quot;,1,33.3,Flat
<span class="linenos"> 5</span>&quot;POLYGON ((-122.5313485 37.9236359, -122.5314032 37.9235355, -122.5313854 37.9235295, -122.5314233 37.9234598, -122.5313427 37.9234325, -122.5313266 37.9234621, -122.5312801 37.9234464, -122.5312325 37.9235337, -122.5312816 37.9235503, -122.5312527 37.9236034, -122.5313485 37.9236359))&quot;,1,30.9,Gable
<span class="linenos"> 6</span>&quot;POLYGON ((-122.4995951 37.9230744, -122.4997138 37.9230726, -122.4997147 37.9231069, -122.4997812 37.9231059, -122.4997844 37.9232311, -122.4996727 37.9232328, -122.4996732 37.9232531, -122.4995879 37.9232544, -122.4995842 37.9231057, -122.4995959 37.9231055, -122.4995951 37.9230744))&quot;,1,26.2,Gable
<span class="linenos"> 7</span>&quot;POLYGON ((-122.4963758 37.9175472, -122.4963943 37.9175454, -122.4963881 37.9175066, -122.4964082 37.9175046, -122.4964121 37.9175289, -122.4964473 37.9175254, -122.4964431 37.9174995, -122.4964598 37.9174978, -122.4964653 37.9175318, -122.4965734 37.9175209, -122.4965892 37.9176185, -122.4965014 37.9176273, -122.4965027 37.9176355, -122.4963919 37.9176466, -122.4963758 37.9175472))&quot;,2,38.5,Flat
<span class="linenos"> 8</span>&quot;POLYGON ((-122.5291925 37.9290674, -122.5290991 37.9290669, -122.5291003 37.9289088, -122.5292526 37.9289095, -122.5292519 37.9290096, -122.5291929 37.9290093, -122.5291925 37.9290674))&quot;,2,43.4,Flat
<span class="linenos"> 9</span>&quot;POLYGON ((-122.5067624 37.924188, -122.5069005 37.9242765, -122.5068342 37.9243409, -122.5068209 37.9243324, -122.506798 37.9243546, -122.5068118 37.9243635, -122.5067734 37.9244008, -122.5066786 37.9243401, -122.5067076 37.9243118, -122.5066638 37.9242837, -122.5067624 37.924188))&quot;,1,23.9,Hip
<span class="linenos">10</span>&quot;POLYGON ((-122.5254005 37.9251584, -122.525388 37.9252686, -122.5253828 37.9253305, -122.5253321 37.9253278, -122.5253375 37.9252645, -122.5252778 37.9252614, -122.525287 37.9251524, -122.5254005 37.9251584))&quot;,1,31.6,Flat
<span class="linenos">11</span>&quot;POLYGON ((-122.5217461 37.9312052, -122.5216466 37.9313318, -122.5214937 37.931257, -122.5215329 37.9312072, -122.5215361 37.9312088, -122.521561 37.9311772, -122.5215984 37.9311955, -122.5216339 37.9311503, -122.5217461 37.9312052))&quot;,1,22.2,Gable
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ol class="arabic simple">
<li><p>To successfully run this example, you need to replace the text on line 6 “PROVIDE_YOUR_KEY” with your Google API key. Instructions on obtaining a Google API key can be found here: <a class="reference external" href="https://developers.google.com/maps/documentation/embed/get-api-key">https://developers.google.com/maps/documentation/embed/get-api-key</a>. BRAILS uses Maps Static API and Street View Static API to access satellite and street-level imagery, so please make sure to enable these APIs with your Google API key.</p></li>
<li><p>Once the code is executed, it will create tmp folder in the directory it is executed. This folder will contain the pretrained BRAILS models (which may take a moment to download the first time you run the example) in “tmp/models” and images accessed from Google APIs in “tmp/images” folder. <code class="code highlight python docutils literal highlight-python"><span class="n">InventoryGenerator</span></code> will download satellite images for the roof shapes and place them in “tmp/images/satellite” folder. It will download street-level images for calculating the building heights and number of stories and save them in the “tmp/images/street” folder. The folders for satellite and street-level imagery are required to run Example 2.</p></li>
<li><p>For best results with BRAILS classification models, it is essential to retrain a pretrained model with data specific to the region for which inventory information is required. The procedure for retraining existing BRAILS modules is discussed in Example 3.</p></li>
</ol>
</div>
</div>
<div class="section" id="example-2-calling-individual-modules-of-brails">
<h2><span class="section-number">4.2. </span>Example 2: Calling Individual Modules of BRAILS<a class="headerlink" href="#example-2-calling-individual-modules-of-brails" title="Permalink to this heading">¶</a></h2>
<p>This example demonstrates the use of specific modules within BRAILS to predict certain building attributes from a provided set of images. The code below assumes that the folders of images on which the inferences will be performed, i.e., “tmp/images/satellite” and “tmp/images/street”, are located in the directory where this code is executed. If this example is run after Example 1, these images will already be located in the specified directories.</p>
<p>The following code runs BRAILS roof shape and occupancy type prediction modules for satellite and street-level imagery located in “tmp/images/satellite” and “tmp/images/street” folders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">brails.modules</span> <span class="kn">import</span> <span class="n">PytorchRoofClassifier</span><span class="p">,</span> <span class="n">PytorchOccupancyClassifier</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">glob</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Initialize a roof classifier:</span>
<span class="linenos"> 5</span><span class="n">roofModel</span> <span class="o">=</span> <span class="n">PytorchRoofClassifier</span><span class="p">()</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Use the roof classifier to infer the roof class for each image contained in tmp/images/satellite/ folder:</span>
<span class="linenos"> 8</span><span class="n">imgs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;tmp/images/satellite/*&#39;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">roofModel</span><span class="o">.</span><span class="n">predictMultipleImages</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="c1"># Initialize an occupancy classifier:</span>
<span class="linenos">12</span><span class="n">occupancyModel</span> <span class="o">=</span> <span class="n">PytorchOccupancyClassifier</span><span class="p">()</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="c1"># Use the occupancy classifier to infer the occupancy type for the building images located in tmp/images/street/ folder:</span>
<span class="linenos">15</span><span class="n">imgs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;tmp/images/street/*&#39;</span><span class="p">)</span>
<span class="linenos">16</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">occupancyModel</span><span class="o">.</span><span class="n">predictMultipleImages</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the code is executed, two CSV files will be created in the tmp folder, Occupancy_preds.csv, and roofType_preds.csv. These files contain the information deduced by each module for the input images. For example, the roofType_preds.csv file for the set of building images obtained after Example 1 results in the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">image</span><span class="p">,</span><span class="n">prediction</span><span class="p">,</span><span class="n">probability</span>
<span class="linenos"> 2</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">8.</span><span class="n">png</span><span class="p">,</span><span class="n">flat</span><span class="p">,</span><span class="mf">0.7034066319465637</span>
<span class="linenos"> 3</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">14.</span><span class="n">png</span><span class="p">,</span><span class="n">hipped</span><span class="p">,</span><span class="mf">0.8674657344818115</span>
<span class="linenos"> 4</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">17.</span><span class="n">png</span><span class="p">,</span><span class="n">flat</span><span class="p">,</span><span class="mf">0.7297888994216919</span>
<span class="linenos"> 5</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">19.</span><span class="n">png</span><span class="p">,</span><span class="n">gabled</span><span class="p">,</span><span class="mf">0.9999415874481201</span>
<span class="linenos"> 6</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">4.</span><span class="n">png</span><span class="p">,</span><span class="n">gabled</span><span class="p">,</span><span class="mf">1.0</span>
<span class="linenos"> 7</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">16.</span><span class="n">png</span><span class="p">,</span><span class="n">flat</span><span class="p">,</span><span class="mf">1.0</span>
<span class="linenos"> 8</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">12.</span><span class="n">png</span><span class="p">,</span><span class="n">flat</span><span class="p">,</span><span class="mf">0.9999819993972778</span>
<span class="linenos"> 9</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">11.</span><span class="n">png</span><span class="p">,</span><span class="n">hipped</span><span class="p">,</span><span class="mf">0.9999932050704956</span>
<span class="linenos">10</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">10.</span><span class="n">png</span><span class="p">,</span><span class="n">flat</span><span class="p">,</span><span class="mf">1.0</span>
<span class="linenos">11</span><span class="n">tmp</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">satellite</span><span class="o">/</span><span class="mf">3.</span><span class="n">png</span><span class="p">,</span><span class="n">gabled</span><span class="p">,</span><span class="mf">0.8481845259666443</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ol class="arabic simple">
<li><p>This example assumes the inference images are stored in tmp/images/satellite and tmp/images/street folders. If you ran Example 1 beforehand, these folders should already be populated as expected.</p></li>
<li><p>As mentioned in Example 1, for best results, it is essential to retrain a pretrained classification model with data specific to the region for which inventory information is required. The steps to retrain a BRAILS model are illustrated in Example 3.</p></li>
</ol>
</div>
</div>
<div class="section" id="example-3-retraining-existing-modules-of-brails">
<h2><span class="section-number">4.3. </span>Example 3: Retraining Existing Modules of BRAILS<a class="headerlink" href="#example-3-retraining-existing-modules-of-brails" title="Permalink to this heading">¶</a></h2>
<p>This example shows the steps required to retrain an existing BRAILS module using a user-provided training dataset. The script below illustrates this process for BRAILS roof shape classifier module only, but the same steps are applicable to all other BRAILS modules. In this specific implementation, the roof classifier model is retrained for a learning rate (<code class="code highlight python docutils literal highlight-python"><span class="n">lr</span></code>) of 0.001, batch size of 64 (<code class="code highlight python docutils literal highlight-python"><span class="n">batch_size</span></code>), and the number of epochs of 5 (<code class="code highlight python docutils literal highlight-python"><span class="n">epochs</span></code>). These input parameters are training hyperparameters that may depend on the application. At the minimum, retraining a deep learning module typically requires more epochs than in this example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">brails.modules</span> <span class="kn">import</span> <span class="n">PytorchRoofClassifier</span><span class="p">,</span> <span class="n">PytorchOccupancyClassifier</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">glob</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Initialize a roof classifier:</span>
<span class="linenos"> 5</span><span class="n">roofModel</span> <span class="o">=</span> <span class="n">PytorchImageClassifier</span><span class="p">(</span><span class="n">modelName</span><span class="o">=</span><span class="s1">&#39;transformer_rooftype_v1&#39;</span><span class="p">,</span> <span class="n">imgDir</span><span class="o">=</span><span class="s1">&#39;./roofType/&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="c1"># Retrain the BRAILS roof classifier model using the training dataset in roofType folder:</span>
<span class="linenos"> 8</span><span class="n">roofModel</span><span class="o">.</span><span class="n">fine_tuning</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Use the new roof classifier to infer the roof class for each image contained in tmp/images/satellite/ folder:</span>
<span class="linenos">11</span><span class="n">imgs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;tmp/images/satellite/*&#39;</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">roofModel</span><span class="o">.</span><span class="n">predictMultipleImages</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ol class="arabic simple">
<li><p>This example assumes that the user has the training data stored in a folder name roofType in the directory where this code is executed. If the training data is stored elsewhere, please change the input for <code class="code highlight python docutils literal highlight-python"><span class="n">imgDir</span></code> accordingly.</p></li>
<li><p>BRAILS, by default, expects the training data folder to contain three subfolders named flat, gabled, and hipped, with the images for each category saved under their respective folder.</p></li>
</ol>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="bugs.html" class="btn btn-neutral float-right" title="5. Bugs &amp; Feature Requests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="troubleshooting.html" class="btn btn-neutral float-left" title="3. Troubleshooting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2024, The Regents of the University of California.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>